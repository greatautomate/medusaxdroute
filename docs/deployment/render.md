# Deploy MedusaXD API on Render.com

This guide will walk you through deploying MedusaXD API on Render.com with PostgreSQL database and Redis cache.

## Prerequisites

- A GitHub account
- A Render.com account (free tier available)
- Fork of the MedusaXD API repository

## ðŸ†• **2025 Update: Enhanced Database Plans**

Render.com has significantly improved their database offerings:

- **Flexible Plans**: Independent storage and compute scaling
- **Point-in-Time Recovery**: Now available on ALL paid database plans
- **Better Pricing**: Starting at $6/month for Basic-256mb plan
- **Storage Scaling**: Add storage without downtime at $0.30/GB/month
- **New Tiers**: Basic, Pro, and Accelerated tiers for different workloads

## Quick Deploy

[![Deploy to Render](https://render.com/images/deploy-to-render-button.svg)](https://render.com/deploy)

## Manual Deployment Steps

### 1. Fork the Repository

1. Go to [MedusaXD API GitHub repository](https://github.com/MedusaXD/medusaxd-api)
2. Click "Fork" to create your own copy
3. Clone your fork locally (optional)

### 2. Create Render Account

1. Sign up at [render.com](https://render.com)
2. Connect your GitHub account
3. Authorize Render to access your repositories

### 3. Deploy the Application

#### Option A: Using render.yaml (Recommended)

1. In your Render dashboard, click "New +"
2. Select "Blueprint"
3. Connect your forked repository
4. Render will automatically detect the `render.yaml` file
5. Review the configuration and click "Apply"

#### Option B: Manual Setup

1. **Create PostgreSQL Database**
   - Click "New +" â†’ "PostgreSQL"
   - Name: `medusaxd-postgres`
   - **Plan Options (2025 Updated)**:
     - **Free**: 1GB storage, 30-day limit (testing only)
     - **Basic-1gb**: $19/month (recommended for small apps)
     - **Pro-4gb**: $55/month (recommended for production)
   - Region: Choose closest to your users
   - Click "Create Database"

2. **Create Redis Instance (Key Value)**
   - Click "New +" â†’ "Key Value"
   - Name: `medusaxd-redis`
   - **Plan Options**:
     - **Free**: 25MB RAM, ephemeral storage (testing only)
     - **Starter**: $10/month, 256MB RAM, persistent storage (recommended)
   - Region: Same as PostgreSQL
   - Click "Create Key Value"

3. **Create Web Service**
   - Click "New +" â†’ "Web Service"
   - Connect your forked repository
   - Configure the service:
     - **Name**: `medusaxd-api`
     - **Environment**: Docker
     - **Plan**: Starter (free) or higher
     - **Branch**: main
     - **Dockerfile Path**: `./Dockerfile`

### 4. Configure Environment Variables

Add the following environment variables to your web service:

#### Database Configuration
```
DATABASE_URL=<auto-filled from PostgreSQL service>
REDIS_CONN_STRING=<auto-filled from Redis service>
```

#### Core Settings
```
TZ=UTC
ERROR_LOG_ENABLED=true
STREAMING_TIMEOUT=120
SESSION_SECRET=<auto-generated>
CRYPTO_SECRET=<auto-generated>
```

#### Feature Flags
```
FORCE_STREAM_OPTION=true
GET_MEDIA_TOKEN=true
GET_MEDIA_TOKEN_NOT_STREAM=true
UPDATE_TASK=true
GENERATE_DEFAULT_TOKEN=false
DIFY_DEBUG=true
```

#### Provider Settings
```
COHERE_SAFETY_SETTING=NONE
GEMINI_VISION_MAX_IMAGE_NUM=16
AZURE_DEFAULT_API_VERSION=2025-04-01-preview
MAX_FILE_DOWNLOAD_MB=20
NOTIFICATION_LIMIT_DURATION_MINUTE=10
NOTIFY_LIMIT_COUNT=2
```

### 5. Deploy and Verify

1. Click "Create Web Service"
2. Render will build and deploy your application
3. Monitor the build logs for any issues
4. Once deployed, access your application at the provided URL
5. Verify the deployment by visiting `/api/status`

## Database Migration

MedusaXD API will automatically run database migrations on startup. No manual intervention required.

## Custom Domain (Optional)

1. In your web service settings, go to "Settings" â†’ "Custom Domains"
2. Add your domain name
3. Configure DNS records as instructed by Render
4. Enable automatic SSL certificate

## Environment-Specific Configuration

### Production Recommendations

- Upgrade to paid plans for better performance and reliability
- Enable automatic deploys from your main branch
- Set up monitoring and alerts
- Configure backup strategies for your database
- Use environment-specific configuration

### Development/Staging

- Use free tier resources
- Enable manual deploys for testing
- Use separate database instances

## Troubleshooting

### Common Issues

1. **Build Failures**
   - Check Dockerfile syntax
   - Verify all dependencies are included
   - Review build logs for specific errors

2. **Database Connection Issues**
   - Ensure DATABASE_URL is correctly set
   - Verify PostgreSQL service is running
   - Check network connectivity

3. **Redis Connection Issues**
   - Verify REDIS_CONN_STRING is set
   - Ensure Redis service is running
   - Check Redis configuration

### Getting Help

- Check Render's [documentation](https://render.com/docs)
- Review MedusaXD API [documentation](https://docs.medusaxd.com)
- Open an issue on [GitHub](https://github.com/MedusaXD/medusaxd-api/issues)

## Cost Optimization

### Free Tier Limits (2025 Updated)

- **Web Service**: 750 hours/month (sleeps after 15 minutes of inactivity)
- **PostgreSQL**: 1GB storage, 30-day expiration, 256MB RAM
- **Key Value (Redis)**: 25MB memory, ephemeral storage

### Recommended Production Setup

#### Minimal Production ($32/month total)
- **Web Service**: Starter ($7/month) - 512MB RAM, no sleep
- **PostgreSQL**: Basic-1gb ($19/month) - 1GB RAM, point-in-time recovery
- **Key Value**: Starter ($10/month) - 256MB RAM, persistent storage

#### Standard Production ($80/month total)
- **Web Service**: Standard ($25/month) - 2GB RAM, better performance
- **PostgreSQL**: Pro-4gb ($55/month) - 4GB RAM, high availability, read replicas
- **Key Value**: Standard ($32/month) - 1GB RAM, better performance

#### High-Performance ($185/month total)
- **Web Service**: Pro ($85/month) - 4GB RAM, priority support
- **PostgreSQL**: Pro-8gb ($100/month) - 8GB RAM, production-ready
- **Key Value**: Pro ($135/month) - 5GB RAM, high performance

## Security Considerations

1. **Environment Variables**: Never commit secrets to your repository
2. **Database Access**: Use strong passwords and limit access
3. **SSL/TLS**: Always use HTTPS in production
4. **Updates**: Keep your application and dependencies updated
5. **Monitoring**: Set up logging and monitoring for security events

## Next Steps

After successful deployment:

1. Configure your AI provider API keys
2. Set up user authentication
3. Configure rate limiting and quotas
4. Set up monitoring and alerts
5. Create backup strategies
6. Plan for scaling as usage grows
